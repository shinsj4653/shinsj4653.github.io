{"componentChunkName":"component---src-templates-post-template-tsx","path":"/블로그추가기능_TableOfContents/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"tableOfContents":"<ul>\n<li><a href=\"#toc-%EC%98%B5%EC%85%98-%EC%B6%94%EA%B0%80\">TOC 옵션 추가</a></li>\n<li><a href=\"#%EC%B2%AB%EB%B2%88%EC%A7%B8-%EB%AC%B8%EC%A0%9C%EC%A0%90--%EB%AA%A9%EC%B0%A8%EC%99%80-%EB%82%B4%EC%9A%A9%EA%B0%84%EC%9D%98-linking-%EB%AC%B8%EC%A0%9C\">첫번째 문제점 : 목차와 내용간의 Linking 문제</a></li>\n<li><a href=\"#%EB%91%90%EB%B2%88%EC%A7%B8-%EB%AC%B8%EC%A0%9C%EC%A0%90--%EB%92%A4%EB%A1%9C%EA%B0%80%EA%B8%B0-%EB%B2%84%ED%8A%BC-%EA%B8%B0%EB%8A%A5-%EC%83%81%EC%8B%A4\">두번째 문제점 : 뒤로가기 버튼 기능 상실</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\">참고 사이트</a></li>\n</ul>","html":"<h1 id=\"toc-옵션-추가\" style=\"position:relative;\">TOC 옵션 추가<a href=\"#toc-%EC%98%B5%EC%85%98-%EC%B6%94%EA%B0%80\" aria-label=\"toc 옵션 추가 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>블로그 글의 목차에 해당하는 Table Of Contents를 만들어보기로 하였다. 블로그 글의 내용의 h1, h2, h3 총 3종류의 태그를 중심으로 목차의 중심을 잡기로 결정하였다. 포스팅 글의 template을 담당하는 post_template.tsx에서 graphql 부분에 다음과 같이 코드를 수정하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> queryMarkdownDataBySlug <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query queryMarkdownDataBySlug($slug: String) {\n    allMarkdownRemark(filter: { fields: { slug: { eq: $slug } } }) {\n      edges {\n        node {\n          tableOfContents // 추가!\n          html\n          frontmatter {\n            title\n            summary\n            date(formatString: \"YYYY.MM.DD.\")\n            categories\n            thumbnail {\n              childImageSharp {\n                gatsbyImageData\n              }\n              publicURL\n            }\n          }\n        }\n      }\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>query문에 tableOfContents를 추가해주면 자동적으로 마크다운 파일에서 h1, h2, h3 태그 정보들을 가져와준다. 수집된 헤더 정보들을 바탕으로 ul과 li 태그들을 자동으로 생성해주어서 너무 편리했다. GlobalStyles.tsx 파일에서 ul과 li 태그들의 스타일링까지 마무리를 해주었다. 하지만, 여기서 문제가 발생하였다.</p>\n<h1 id=\"첫번째-문제점--목차와-내용간의-linking-문제\" style=\"position:relative;\">첫번째 문제점 : 목차와 내용간의 Linking 문제<a href=\"#%EC%B2%AB%EB%B2%88%EC%A7%B8-%EB%AC%B8%EC%A0%9C%EC%A0%90--%EB%AA%A9%EC%B0%A8%EC%99%80-%EB%82%B4%EC%9A%A9%EA%B0%84%EC%9D%98-linking-%EB%AC%B8%EC%A0%9C\" aria-label=\"첫번째 문제점  목차와 내용간의 linking 문제 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>tableOfContents 정보는 잘 가져왔는데 클릭 시, 그 내용으로 글이 움직이질 않았다. 첫번째 참고 사이트대로 gatsby-remark-autolink-headers를 잘 설치하였고, gatsby-config.js에도 추가를 해주었는데도 링킹이 작동하지 않았다. 그래서, gatsby 공식문서를 읽어보기로 하였다.<br>\ngatsby 공식문서의 gatsby-remark-autolink-headers 부분을 읽어보니, 자신이 링크를 걸어주고 싶은 헤더 태그를 직접 지정할 수 있는 옵션이 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-remark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n\t<span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token operator\">...</span>\n\t\t<span class=\"token punctuation\">{</span>\n       <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token string\">'gatsby-remark-autolink-headers'</span><span class=\"token punctuation\">,</span>\n       <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token literal-property property\">elements</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">h1</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">h2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">h3</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\t\t <span class=\"token operator\">...</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 h1, h2, h3를 지정해주니, 성공적으로 linking 작업을 완료할 수 있었다.</p>\n<h1 id=\"두번째-문제점--뒤로가기-버튼-기능-상실\" style=\"position:relative;\">두번째 문제점 : 뒤로가기 버튼 기능 상실<a href=\"#%EB%91%90%EB%B2%88%EC%A7%B8-%EB%AC%B8%EC%A0%9C%EC%A0%90--%EB%92%A4%EB%A1%9C%EA%B0%80%EA%B8%B0-%EB%B2%84%ED%8A%BC-%EA%B8%B0%EB%8A%A5-%EC%83%81%EC%8B%A4\" aria-label=\"두번째 문제점  뒤로가기 버튼 기능 상실 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>기존의 포스트 글에서 메인화면으로 돌아가는 뒤로가기 버튼은 다음과 같이 설계되어 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token literal-property property\">PostHeadInfo</span><span class=\"token operator\">:</span> FunctionComponent<span class=\"token operator\">&lt;</span>PostHeadInfoProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n  title<span class=\"token punctuation\">,</span>\n  date<span class=\"token punctuation\">,</span>\n  categories<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">goBackPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>history<span class=\"token punctuation\">.</span><span class=\"token function\">back</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>PostHeadInfoWrapper<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>PrevPageIcon onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>goBackPage<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>FontAwesomeIcon icon<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>faArrowLeft<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>PrevPageIcon<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Title<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Title<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>PostData<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>categories<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">' / '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>PostData<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>PostHeadInfoWrapper<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>하지만, ToC의 링크 작업 이후에는 Toc의 각 항목들을 누르면 사이트의 주소창의 정보가 그 누른 항목에 따라 바뀌게 된다. 즉, 뒤로가기를 누르면 메인화면으로 돌아가는 것이 아닌 이전에 클릭한 항목으로만 돌아가게 되었다.<br>\n메인화면으로 돌아가게 하기 위해서 <code class=\"language-text\">location.replace('/')</code>를 활용하기로 하였다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">goBackPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>replace함수를 사용하게 되면 기존의 위치로 back하는 작업을 할 수 없다고 한다. 왜냐하면, currentPage 정보가 세션 히스토리에 저장되지 않기 떄문이다. 하지만 우리는 메인화면으로만 가면 되기 때문에 큰 문제는 없을 것 같다.</p>\n<h1 id=\"참고-사이트\" style=\"position:relative;\">참고 사이트<a href=\"#%EC%B0%B8%EA%B3%A0-%EC%82%AC%EC%9D%B4%ED%8A%B8\" aria-label=\"참고 사이트 permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<ul>\n<li>\n<p><a href=\"https://soopdop.github.io/2020/12/03/add-table-of-content-gatsby/\" target=\"_blank\" rel=\"nofollow\">Gatsby Blog에 목차 추가하기</a></p>\n</li>\n<li>\n<p><a href=\"https://www.gatsbyjs.com/plugins/gatsby-remark-autolink-headers/\" target=\"_blank\" rel=\"nofollow\">TOC option 추가</a></p>\n</li>\n<li>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/API/Window/history\" target=\"_blank\" rel=\"nofollow\">location.replace()</a></p>\n</li>\n<li>\n<p><a href=\"https://enidanny.github.io/github%20blog/github-start-two/\" target=\"_blank\" rel=\"nofollow\">TOC 디자인 참고</a></p>\n</li>\n</ul>","frontmatter":{"title":"블로그 기능 추가 2 - Table Of Contents","summary":"블로그에 있는 각 게시글에 TOC를 어떻게 적용했는지 정리","date":"2022.08.14.","categories":["Gatsby","JavaScript"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABk0lEQVQoz51RS0sCURj110SEjc7MHTfRtm0uIoKocJy5V+i16LHJKAuCIigcvHPvDcseNJXhoihLSu1FBJVhBUHSSggCiaCgZVyNHgsXBYfvOx98Bw7n2KBM/w1baSFAkcI4Kc4/iBGgmtP02LEmEk81hoByyFSXPwkCZcQIUK/T7KqdnR1MWhPHo83rqoB1kWgiQQrjxEk89pAmEihTzcknlIr4FDtMa/w4nys8P73m7wtDDatQppFAKti1DWXaWRsONEURYEZ33O+2uDWZ+hQGJWrTRdJRE95bzp4ncm8v7/dXj9PtW8ONa9Gp06Wxo1T0ZnPm4mTjLj6X2VvO7q9cx4yzhdH0l22mVuOwP7kTyVwmH9LR2766RaSwuaFUJJAm/YnIcGpS38A9u/MjB2ZvImacBbvjLZUGUhgPTJcIBBT37CyNHQ7UW6pg6hJRHabHHmqrCnkdpipgLz+xKmC/2/K5GJd8VQUl0lpptFQEVQGXEoaAQcCQwniLxfxR8eRxSr975n24mM/FyrXy/fbj4QOt/xMjko0zhgAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/523966a55687de90fff1a38556452d10/f1c8e/thumbnail-gatsby.png","srcSet":"/static/523966a55687de90fff1a38556452d10/14dc0/thumbnail-gatsby.png 175w,\n/static/523966a55687de90fff1a38556452d10/2a0b0/thumbnail-gatsby.png 350w,\n/static/523966a55687de90fff1a38556452d10/f1c8e/thumbnail-gatsby.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/523966a55687de90fff1a38556452d10/486e0/thumbnail-gatsby.webp 175w,\n/static/523966a55687de90fff1a38556452d10/6b67d/thumbnail-gatsby.webp 350w,\n/static/523966a55687de90fff1a38556452d10/e8085/thumbnail-gatsby.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":367}},"publicURL":"/static/523966a55687de90fff1a38556452d10/thumbnail-gatsby.png"}}}}]}},"pageContext":{"slug":"/블로그추가기능_TableOfContents/"}},"staticQueryHashes":[]}