{"componentChunkName":"component---src-templates-post-template-tsx","path":"/10분만에 알아보는 MobX와 React/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<blockquote>\n<p>참고 블로그의 제목대로 정말 10분만에 MobX가 이해가 될까했는데 진짜로 금방 이해가 되어서 깜짝 놀란 글이다. 핵심적인 내용을 잘 설명해준 것 같아 MobX에 대한 자신감도 상승하였다.</p>\n</blockquote>\n<h1>핵심개념</h1>\n<p>총 4가지의 핵심 개념, State, Derviations, Reactions, Actions가 있다.</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 616px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f8fd5243e74a128dee0771f9a9f00e81/274fb/mobx-flow2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACNUlEQVQ4y32TfU/bMBDG+/2/zKRpf+1FaIwhQUGlINi60kKhtIQ2JE3j2I7P/k1xW8jYtJOsnC6+557n7txha5ly3KaWybOlNLILE0L4p18HS2aWKFfQts7aCM/KcbOo6I0Szm9THjIbY1Xt4yURj/c+AtZiKfSKy8kZ/ZsT+jddknyGFYP3QqfQDgkQxHF48I3z/lkE0bWgXUCVa9I0xTkX40Y0la447h6z/3Wfvb09kiRBcDip6eSVQ9WeolTM5o/M5gmqMhRGovSmqrWW1WoVE2sxL/Kmd1PWq3X0rTOId3SM86y1cJ1U9Kcl5w+Ku1RHsFoCWuuYMBwOGQwG0S+d4i6fcDW9ZJxek+kUXSukkbyr1sheFIYkU7R6zzJNqaqKLMvQVQXOIfM5y4su44tDnu5/YHXJLikC1rUjeM/kdsz3g/3NAFqTNWYjMzRsjWHU69H9+ImTz19YjMYNANIU2wE2/Tk6OmIwGNI96e2QIthuVZqvKBX9QmuuhkN+jkaU1m4U7gDbu0WweLsEr14ZtvZPynKTaC15klAsFtFvCvltsU5kIk1vMmzWwy4PkfwU7GOMhyCv4CJ4azGTCevT03jMdEqo6/hvC+jwNgU8o+EVH96/4/ysCziCywmi/noljfmqwm83oP2SOsHXhO3zUdrxMHsiy7cg3hCk3DB809M2SDveiZJcDvUzUv7CFQOkHBBsAg1Db/4Y0luQduxlyvGyr8HcQ3kJ1QhEvbJ5w+p/9htrIjp/CXzxlgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/f8fd5243e74a128dee0771f9a9f00e81/a59e9/mobx-flow2.webp 192w,\n/static/f8fd5243e74a128dee0771f9a9f00e81/0ca9f/mobx-flow2.webp 384w,\n/static/f8fd5243e74a128dee0771f9a9f00e81/cec2c/mobx-flow2.webp 616w\" sizes=\"(max-width: 616px) 100vw, 616px\" type=\"image/webp\">\n          <source srcset=\"/static/f8fd5243e74a128dee0771f9a9f00e81/3b721/mobx-flow2.png 192w,\n/static/f8fd5243e74a128dee0771f9a9f00e81/66595/mobx-flow2.png 384w,\n/static/f8fd5243e74a128dee0771f9a9f00e81/274fb/mobx-flow2.png 616w\" sizes=\"(max-width: 616px) 100vw, 616px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/f8fd5243e74a128dee0771f9a9f00e81/274fb/mobx-flow2.png\" alt=\"mobx-flow\" title=\"mobx-flow\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span></img></p>\n<ol>\n<li>\n<p>State</p>\n<p>웹 어플리케이션에 존재하는 데이터들(객체, 배열, 원시 값, 참조 등등)이다.</p>\n</li>\n<li>\n<p>Derivation<br>\nstate로부터 자동으로 계산될 수 있는 값이다. ‘완료되지 않은 todo 개수’나, ‘todo에 관한 시각적 HTML표현’ 등이 있다. 어플리케이션의 수식 또는 차트라고 표현한다.</p>\n</li>\n<li>\n<p>Reaction<br>\nDerivation과 굉장히 유사하지만, 값을 생성하는 대신에 자동으로 특정 테스크를 수행한다. DOM 요소가 업데이트 되었는지, 또는 네트워크 요청이 제떄 자동적으로 이루어졌는지를 확인한다.</p>\n</li>\n<li>\n<p>Action<br>\nstate를 변경하는 모든 것을 의미한다.</p>\n</li>\n</ol>\n<h1>TodoStore 예제</h1>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">TodoStore</span> <span class=\"token punctuation\">{</span>\r\n  todos <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n\r\n  <span class=\"token keyword\">get</span> <span class=\"token function\">completedTodosCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>todo <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>completed <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'&lt;none>'</span>\r\n    <span class=\"token keyword\">const</span> nextTodo <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>todo <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>completed <span class=\"token operator\">===</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Next todo: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>nextTodo <span class=\"token operator\">?</span> nextTodo<span class=\"token punctuation\">.</span>task <span class=\"token operator\">:</span> <span class=\"token string\">'&lt;none>'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\". </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\r\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Progress: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>completedTodosCount<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\r\n    <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      task<span class=\"token operator\">:</span> task<span class=\"token punctuation\">,</span>\r\n      completed<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n      assignee<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">const</span> todoStore <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TodoStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>해야할 todo중, 가장 최신으로 입력된 todo와 현재 완료된 todo갯수까지 출력해주는 예제이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'read MobX tutorial'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\ntodoStore<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'try MobX'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\ntodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>completed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\ntodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>task <span class=\"token operator\">=</span> <span class=\"token string\">'try MobX in own project'</span>\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\ntodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>task <span class=\"token operator\">=</span> <span class=\"token string\">'grok MobX tutorial'</span>\r\n<span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>todoStore<span class=\"token punctuation\">.</span><span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>report에서는 의도적으로 가장 최신으로 입력된 todo를 출력해준다.<br>\n만약 위 코드처럼 일일이 report 함수로 log를 찍는게 아니라, <code class=\"language-text\">state가 변경될때마다</code> report함수를 자동적으로 호출해주고 싶으면 다음과 같이 설계하면된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ObservableTodoStore</span> <span class=\"token punctuation\">{</span>\r\n  todos <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n  pendingRequests <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\r\n\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token function\">makeObservable</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n      todos<span class=\"token operator\">:</span> observable<span class=\"token punctuation\">,</span>\r\n      pendingRequests<span class=\"token operator\">:</span> observable<span class=\"token punctuation\">,</span>\r\n      completedTodosCount<span class=\"token operator\">:</span> computed<span class=\"token punctuation\">,</span>\r\n      report<span class=\"token operator\">:</span> computed<span class=\"token punctuation\">,</span>\r\n      addTodo<span class=\"token operator\">:</span> action<span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token function\">autorun</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>report<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">get</span> <span class=\"token function\">completedTodosCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>todo <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>completed <span class=\"token operator\">===</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">get</span> <span class=\"token function\">report</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'&lt;none>'</span>\r\n    <span class=\"token keyword\">const</span> nextTodo <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>todo <span class=\"token operator\">=></span> todo<span class=\"token punctuation\">.</span>completed <span class=\"token operator\">===</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Next todo: \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>nextTodo <span class=\"token operator\">?</span> nextTodo<span class=\"token punctuation\">.</span>task <span class=\"token operator\">:</span> <span class=\"token string\">'&lt;none>'</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\". </span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\r\n      <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Progress: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>completedTodosCount<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span>length<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\r\n    <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span>task<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n      task<span class=\"token operator\">:</span> task<span class=\"token punctuation\">,</span>\r\n      completed<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n      assignee<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">const</span> observableTodoStore <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ObservableTodoStore</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>TodoStore는 발생한 모든 변화를 MobX가 감지할 수 있도록 <code class=\"language-text\">observable</code> 상태가 되어야 한다.<br>\ncompletedTodosCount나, report 함수처럼 근원적인 state변화가 일어나지 않는 한 해당 값들이 state및 캐시에서 파생될 수 있으므로, <code class=\"language-text\">computed</code>로 명시해준다.<br>\nstate가 변경될 때마다 report함수를 실행해야하므로, <code class=\"language-text\">autorun</code>으로 함수를 감싸줘야한다.<br>\nautorun은 한 번 실행되는 <code class=\"language-text\">reaction</code>을 만들고 이후에 함수 안에서 사용된 observable데이터가 변경될 때마다 자동으로 reaction을 재실행한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">observableTodoStore<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'read MobX tutorial'</span><span class=\"token punctuation\">)</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'try MobX'</span><span class=\"token punctuation\">)</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>completed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>task <span class=\"token operator\">=</span> <span class=\"token string\">'try MobX in own project'</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>task <span class=\"token operator\">=</span> <span class=\"token string\">'grok MobX tutorial'</span></code></pre></div>\n<p>위의 코드에서 다섯 번째줄은 로그가 안 찍히는데 그 이유는 report가 return해주는 값이 바뀌지 실질적으로 바뀌지 않았기 때문이다. 반면 인덱스 1번 todo의 이름은 report에서 활성화되어있었기 때문에 해당 이름을 변경하면 report가 업데이트 된다.<br>\n-> autorun이 todos배열뿐만 아니라, todo항목 내의 개별 속성까지 감지하고 있음을 의미한다.</p>\n<h1>반응형 React 만들기</h1>\n<p>React 컴포넌트를 반응형으로 만들기 위해서는, mobx-react-lite 패키지의 observer HoC 래퍼를 활용해야한다. 개념적으로 위의 report함수와 똑같다고 볼 수 있다.<br>\nobserver래핑을 통해 각각의 컴포넌트들은 관련 데이터가 변경될때마다 <code class=\"language-text\">각자 따로 재렌더링</code>한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> TodoList <span class=\"token operator\">=</span> <span class=\"token function\">observer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> store <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onNewTodo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    store<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enter a new todo:'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'coffee plz'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\r\n      <span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">.</span>report<span class=\"token punctuation\">}</span>\r\n      <span class=\"token operator\">&lt;</span>ul<span class=\"token operator\">></span>\r\n        <span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>todo<span class=\"token punctuation\">,</span> idx<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\r\n          <span class=\"token operator\">&lt;</span>TodoView todo<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">}</span> key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>idx<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\r\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ul<span class=\"token operator\">></span>\r\n      <span class=\"token punctuation\">{</span>store<span class=\"token punctuation\">.</span>pendingRequests <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token operator\">&lt;</span>marquee<span class=\"token operator\">></span>Loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>marquee<span class=\"token operator\">></span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span>\r\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onNewTodo<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>New Todo<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span>small<span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>double<span class=\"token operator\">-</span>click a todo to edit<span class=\"token punctuation\">)</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>small<span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span>RenderCounter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">const</span> TodoView <span class=\"token operator\">=</span> <span class=\"token function\">observer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> todo <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onToggleCompleted</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    todo<span class=\"token punctuation\">.</span>completed <span class=\"token operator\">=</span> <span class=\"token operator\">!</span>todo<span class=\"token punctuation\">.</span>completed\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onRename</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    todo<span class=\"token punctuation\">.</span>task <span class=\"token operator\">=</span> <span class=\"token function\">prompt</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Task name'</span><span class=\"token punctuation\">,</span> todo<span class=\"token punctuation\">.</span>task<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> todo<span class=\"token punctuation\">.</span>task\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">&lt;</span>li onDoubleClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onRename<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span>input\r\n        type<span class=\"token operator\">=</span><span class=\"token string\">\"checkbox\"</span>\r\n        checked<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>completed<span class=\"token punctuation\">}</span>\r\n        onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onToggleCompleted<span class=\"token punctuation\">}</span>\r\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n      <span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>task<span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>assignee <span class=\"token operator\">?</span> <span class=\"token operator\">&lt;</span>small<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>todo<span class=\"token punctuation\">.</span>assignee<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>small<span class=\"token operator\">></span> <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">}</span>\r\n      <span class=\"token operator\">&lt;</span>RenderCounter <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token operator\">&lt;</span>TodoList store<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>observableTodoStore<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span>\r\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'reactjs-app'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>TodoList컴포넌트에서 observer를 제외하면 onNewTodo함수가 작동하지 않는다. store라는 데이터를 observe 하지 않는 상태이기 때문에 store의 addTodo 함수가 작동하지 않는다.<br>\nTodoView의 observer를 없애면, todo를 toggle할 때 그 todo만 업데이트가 되는 것이 아니라 모든 todo가 업데이트가 된다. 불필요한 render가 엄청나게 많이 일어나는 것이다.</p>\n<h1>참조(reference) 작업</h1>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> peopleStore <span class=\"token operator\">=</span> <span class=\"token function\">observable</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Michel'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> name<span class=\"token operator\">:</span> <span class=\"token string\">'Me'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>assignee <span class=\"token operator\">=</span> peopleStore<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\r\nobservableTodoStore<span class=\"token punctuation\">.</span>todos<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>assignee <span class=\"token operator\">=</span> peopleStore<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\r\npeopleStore<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'Michel Weststrate'</span></code></pre></div>\n<p>위에서 만든 todo로 이루어진 store와 사람으로 이루어진 peopleStore, 총 2개의 store가 있는 상태이다. peopleStore의 사람 데이터를 store의 todo.assignee 변수에 넣어줌으로써 참조를 하게 된다. 이 변화들은 TodoView에 의해 자동으로 감지된다. 객체들이 observable이기만 하면 데이터가 어디에 저장되어 있든 MobX가 감지할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token special-attr\"><span class=\"token attr-name\">onkeyup</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value javascript language-javascript\">peopleStore<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value</span><span class=\"token punctuation\">\"</span></span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>참조를 하고나면, <code class=\"language-text\">observable</code>로 감싸줬기 때문에 input태그의 값을 바꾸면 store의 todos[1].assignee 값도 동시에 바뀌는 걸 확인할 수 있다.</p>\n<h1>비동기식 action</h1>\n<p>todo 어플리케이션의 모든 것은 state로부터 파생되었기 때문에 state가 <code class=\"language-text\">언제</code>변경되든 상관없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\">observableTodoStore<span class=\"token punctuation\">.</span>pendingRequests<span class=\"token operator\">++</span>\r\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>\r\n  <span class=\"token function\">action</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    observableTodoStore<span class=\"token punctuation\">.</span><span class=\"token function\">addTodo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Random Todo '</span> <span class=\"token operator\">+</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    observableTodoStore<span class=\"token punctuation\">.</span>pendingRequests<span class=\"token operator\">--</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token number\">2000</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>로딩상태를 반영하기 위해 store의 pendingRequests속성을 업데이트해준다.</p>\n<p>여러개의 todo들을 동시에 많이 생성하여도 로딩이 끝나고 나서 todo를 업데이트하고, pendingRequests속성을 감소신킨다.</p>\n<h1>요약</h1>\n<ol>\n<li>\n<p>observable 데코레이터 또는 observable(객체 또는 배열) 함수를 사용하여 MobX가 객체를 트래킹 할 수 있도록 만들면 된다.</p>\n</li>\n<li>\n<p>computed 데코레이터는 state로부터 자동으로 값을 가져와 캐시 할 수 있는 함수를 만드는 데 사용할 수 있다.</p>\n</li>\n<li>\n<p>observable한 state 기반의 함수들을 자동으로 실행하기 위해서는 autorun을 사용해야한다. 로깅, 네트워크 요청 등에 유용하다.</p>\n</li>\n<li>\n<p>mobx-react-lite 패키지의 observer를 사용하여 React 컴포넌트가 진정으로 reactive 하도록 만들면 된다. 거대한 양의 데이터를 사용하는 복잡한 애플리케이션에 사용되더라도 자동적으로, 효율적으로 업데이트하는 효과를 누릴 수 있다.</p>\n</li>\n</ol>\n<h1>참고사이트</h1>\n<ul>\n<li><a href=\"https://ko.mobx.js.org/getting-started.html\" target=\"_blank\" rel=\"nofollow\">10분만에 알아보는 MobX와 React</a></li>\n</ul>","frontmatter":{"title":"10분만에 알아보는 MobX와 React","summary":"\"10분만에 알아보는 MobX와 React\"글을 읽어보면서 정리하였다.","date":"2022.08.12.","categories":["MobX"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABq0lEQVQoz5WTz0sbURDH809YqAdPpV4VD4L4F1joyavYgKAgSgNBEH9cAkLRQ6xJLT1FY0Rj3UjUaNWCJFUTszFGj4WWGMGgjZXEze4K8pHsdk1CpOrhyzzezPu8mTfzTEp0EXn/K4aVIwvI+6XSfaVx/5OpLDjmQ40voxz4UeN+fS0K/y7yPglqug8SBaSgi2xgnNyGk9w3B9mAnfzODEpUIP/9c7GKB2T4dGDEi3q0RvpDKz/bqvnd/oJf76pIdbwk5+pBOVxB2nQgRxdRRT2TG1HQFfNp1oAWgcfrnNlaSFqbOLHUkx5o4u9wM1eTZpREAGnTqR3I7s5xHfaSCXq4DM1yvu3WrFqR4fE66ZG3JHvryMwMcT1t4aKvnstPZlQN6NCy2XOP4v84yJJ9gIN5O1tfbEQ8Y9zGl8hXAG1vOLU2cmpp4Ly/kTNrHRcTbaiJtcqSY4KWVaHc0mYVgYlV/kyYSXW+ItlVS6r7NSedNWRc71ELb7jlfEZTjI3wHFJoGumHGynkRgpOIYf1cSkFPgQuA5bNl+grl3F41/PMOXyknMIsPuWn3AG3RdWGHcLxngAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/8d3a2e4735647ce02632d7c2e18a00ae/4b4a3/thumbnail-mobx.png","srcSet":"/static/8d3a2e4735647ce02632d7c2e18a00ae/3e7b4/thumbnail-mobx.png 477w,\n/static/8d3a2e4735647ce02632d7c2e18a00ae/c0022/thumbnail-mobx.png 954w,\n/static/8d3a2e4735647ce02632d7c2e18a00ae/4b4a3/thumbnail-mobx.png 1908w","sizes":"(min-width: 1908px) 1908px, 100vw"},"sources":[{"srcSet":"/static/8d3a2e4735647ce02632d7c2e18a00ae/f3bdd/thumbnail-mobx.webp 477w,\n/static/8d3a2e4735647ce02632d7c2e18a00ae/2ef02/thumbnail-mobx.webp 954w,\n/static/8d3a2e4735647ce02632d7c2e18a00ae/c0ebe/thumbnail-mobx.webp 1908w","type":"image/webp","sizes":"(min-width: 1908px) 1908px, 100vw"}]},"width":1908,"height":1070}},"publicURL":"/static/8d3a2e4735647ce02632d7c2e18a00ae/thumbnail-mobx.png"}}}}]}},"pageContext":{"slug":"/10분만에 알아보는 MobX와 React/"}},"staticQueryHashes":[]}